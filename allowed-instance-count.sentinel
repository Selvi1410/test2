import "tfplan/v2 " as tfplan
import "tfconfig/v2" as config


allowed_instant_count = 1


allEC2Instances = config.find_all_resources("aws_instance")


# Warnings will be printed for all violations since the last parameter is true
violatingInstancecount = config.filter_attribute_not_in_list(allEC2Instances,
                        "count", allowed_types, true)


# Main rule
main = rule {length(violatingInstancecount["messages"] is 0)
  
}